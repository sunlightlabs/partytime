{% extends "publicsite_redesign/base.html" %}
{% load static %}
{% load partytime_redesign %}

{% block title %}Calendar {{ week_start|date:"N jS" }} - {{ week_end|date:"N jS" }} - {{block.super}}{% endblock %}

{# Set the nav highlight #}
{% block nav-calendar %}class="active"{% endblock %}

{% block headjs %}<script type="text/javascript" src="http://cdn.gigya.com/js/gigyaGAIntegration.js" ></script>{% endblock %}

{% block container %}
	<div class="graph module">
		<h2>
			Social Calendar
		</h2>
		<ul class="clearfix social">
			<li id="share-buttons">
			</li>
		</ul>
		<div class="clear"></div>

		<div id="weekInParties" style="min-width: 400px; height: 200px; margin: 0 auto">
		</div>
		<div class="focus left"></div>
		<div class="focus right"></div>
	</div>
	<div class="week last module">
		<div class="dateNav pagination">
				<span class="prev"><a class="textReplace" href="{{last_week_url}}">Previous</a></span>
				<time class="pageNum"><h3>{{ week_start|date:"N jS" }} &mdash; {{ week_end|date:"N jS" }}</h3></time>
				<span class="next"><a class="textReplace" href="{{next_week_url}}">Next</a></span>
		</div>



		<div class="days head">
			{% for day in week_data %}
			
			<h4 class="calCol">
				{{ day.dayname }} <time>{{day.date|date:"n/j"}}</time>
			</h4>
			{% endfor %}
		</div>
		<div class="days">
			{% for day in week_data %}
			<div class="calCol events">
				<ol>
					{% for event in day.events %}
					<li>
						<div class="eventData">
							<span class="type">{{ event.truncated_name }}</span>
							{% if event.beneficiaries %}<h5 class="beneficiary">
								{% for beneficiary in event.beneficiaries.all %}{% if forloop.last %}{% else %}, {% endif %}<a href="{{ event.get_absolute_url }}">{{ beneficiary.titled_name }}</a>{% endfor %}
							</h5>
							{% endif %}
							<a href="{{ event.get_absolute_url }}" class="location">{{ event.venue.state_full }}</a>
						</div>
					</li>
					{% endfor %}
				</ol>
			</div>
			{% endfor %}
			
			<div class="clear"></div>
		</div>
	</div>
{% endblock %}


{% block js %}
{{ block.super }}

<script type="text/javascript" src="{% get_static_prefix %}js/jquery-1.5.1.min.js"></script>
<script type="text/javascript" src="{% get_static_prefix %}js/highcharts.js"></script>
<!-- weekinparties.js goes here, i.e. 
<script src="http://assets.sunlightfoundation.com/reporting/partytime_redesign/js/weekInParties.js" type="text/javascript"></script>

-->
<script type="text/javascript">

{% load cache %}
{% cache cache_time cache_key  %}
{% weekinpartiesjs datestring %}
{% endcache %}
</script>

<script src="{% get_static_prefix %}js/gray.js" type="text/javascript"></script>
<script src="http://cdn.gigya.com/js/socialize.js?apiKey=3_BLRB_2LlQJZDUW1wb9_ZOps-sOnnzA_e6xxNSwJBBGoB-SavmPAKHkaVVZPE5Kx8"></script>
<script>
    $(document).ready(function() {
        var ua = new gigya.socialize.UserAction();
        var params = {
            containerID: 'share-buttons',
            layout: 'horizontal',
            shareButtons: [
                {
                    provider: 'facebook-like',
                },
                {
                    provider: 'google-plusone'
                },
                {
                    provider: 'twitter-tweet',
                    related: 'sunfoundation',
                    via: 'sunfoundation'
                },
                {
                    provider: 'email'
                }
            ],
            userAction: ua
        };
        gigya.socialize.showShareBarUI(params);
    });
</script>

{% endblock %}

