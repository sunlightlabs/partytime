{% extends "publicsite_redesign/base.html" %}
{% load partytime %}

{% block headjs %}<script type="text/javascript" src="http://cdn.gigya.com/js/gigyaGAIntegration.js" ></script>
{% endblock %}

{% block title %}	{{ lawmaker.title }} {{ lawmaker.name }} ({{ lawmaker.party }}, {{ lawmaker.state }}) - {{ block.super }}{% endblock %}

		
{% block container %}
<div class="module nineCol colLt entity">
		{% if image_url %}<img src="{{ image_url }}" alt="{{ lawmaker.title }} {{ lawmaker.name }} ({{ lawmaker.party }}, {{ lawmaker.state }})" class="oneCol colLt">{% endif %}
		<div class="leg sevenCol colRt">
			<h2 class="">
				{{ lawmaker.title }} {{ lawmaker.name }} <span class="role">({{ lawmaker.party }}, {{ lawmaker.state }})</span>
			</h2>
			<div class="clear"></div>
			<ul class="clearfix social">
				{% if lawmaker.crp_id %}
				<li>
					<a href="/feeds/pol/{{ lawmaker.crp_id }}/" class="rss textReplace">rss</a>
				</li>
				<li>
					<a href="javascript:gotoscout('http://politicalpartytime.org/feeds/pol/{{ lawmaker.crp_id }}/')" class="">Create an alert</a>
				</li>
				{% endif %}
				{% if lawmaker.crp_id %}
				<li>
					<a href="/widget/pol/{{ lawmaker.crp_id }}/" class="">Share Widget</a>
				</li>
				{% endif %}
			</ul>
			<div class="gigya party" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px;" id="share-buttons"></div>
			<div class="clear"></div>
			{% if lawmaker.congressional_leadership_positions %}
			<h4>Congressional Leadership</h4>
		    <ul class="committees clearfix">
				{% for position in lawmaker.congressional_leadership_positions %}
				<li>{{ position }}</li>
				{% endfor %}
		    </ul>
		    {% endif %}
			
			{% if lawmaker.committee_set.all %}
			<h4>Committee Membership</h4>
			<ul class="committees clearfix">
				{% for committee in lawmaker.committee_set.all %}
				<li>
					{{committee.title}} <span class="role">{{ lawmaker|committee_position:committee }}</span>
				</li>
				{% endfor %}
			</ul>
			{% endif %}
		</div>
	</div>

		<div class="uploadSmall module colRt threeCol ">
			<h3 class="textReplace">Extend an Invite</h3>
			<a class="button" href="">Upload</a>
		</div>
	<div class="clear"></div>

	<div class="partyList last module">
		<div class="tableHat twelveCol aboutParties">
			<h3 class="">
				Beneficiary of {{ event_count }} PT events
			</h3>
			
			<dl class="clearfix">
				<dt>Parties Benefitting</dt>
				<dd>
					<ul>
						<li>
							Campaign Committee
						</li>
						{% if pacname %}
						<li>
							<a href="/search/Beneficiary/{{ pacname }}/">{{ pacname }}</a>
						</li>
						{% endif %}

					</ul>
				</dd>
				{% if current_pagenum %}<dt>Showing page {{ current_pagenum}} of {{ max_pagenum }}</dt>{% endif %}
			</dl>
			<div class="clear"></div>
		</div>
		<table>
			<thead>
				{{ table_header|safe}}
			</thead>
			<tbody>
				{% for result in results %}
				<tr class="{% cycle 'even' 'odd' %}">
					<td>
						{{ result.start_date|date:"m/d/y"}}<br><a href="{{result.get_absolute_url}}">See&nbsp;invite</a>
					</td>
					<td>
						{% for ben in result.beneficiaries.all %}{%if ben.affiliate %}
						<a href="{% url partytime_search 'Beneficiary' ben.name|urlencode %}">{{ ben.name }}</a> (<a href="{% if ben.crp_id %}{% url partytime_pol_detail ben.crp_id %}{% else %}{% url partytime_search 'Beneficiary' ben.affiliate|urlencode %}{% endif %}" style="display:inline;">{{ ben.affiliate }}</a>)
						{%else%}
						<a href="{% if ben.crp_id %}{% url partytime_pol_detail ben.crp_id %}{% else %}{% url partytime_search 'Beneficiary' ben.name|urlencode %}{%endif%}" style="display:inline;">{{ ben }}</a>
						{%endif%}{% endfor %}
					</td>
					<td>
						{% with result.hosts.all as hosts %}
						{% if hosts %}
					    {% for host in hosts %}<a href="{% url partytime_search 'Host' host|urlencode %}" style="display:inline;">{{ host }}</a>{% if forloop.last %}{% else %}, {% endif %}{% endfor %}
						{% endif %}
						{% endwith %}
					</td>
					<td>
						{% if result.entertainment %}{{ result.entertainment }}{% else %}Fundraiser{% endif %}
					</td>
					<td>
						{% if result.venue.venue_name %}<a href="{% url partytime_search 'Venue_Name' result.venue.venue_name|urlencode %}" style="display:inline">{{ result.venue.venue_name }}</a>{% endif %}{% if result.venue.address1 %}{% if result.venue.venue_name %}, {% endif %}{{ result.venue.address1 }}{% endif %}{% if result.venue.address2 %} {{ result.venue.address2 }}{% endif %}{% if result.venue.city %}, {{ result.venue.city }}{% endif %}{% if result.venue.state %}, {{ result.venue.state }}{% endif %}
					</td>
				</tr>		

				{% endfor %}

			</tbody>
		</table>
		
		<div class="pagination">
				{{ paginator_html|safe }}
		</div>
	</div>
{% endblock %}
	
{% block js %}
{{ block.super }}
<script type="text/javascript">

function gotoscout(feedurl) {
	scouturl = "http://scout.sunlightfoundation.com/import/feed?url=" + encodeURIComponent(feedurl);
	appended_url = feedurl.replace("http://reporting.sunlightfoundation.com/outside-spending/recent-FEC-filings/","");
	var gotoscout = confirm("You're being sent to Scout to subscribe to feeds for your selections. If you don't have an account with Scout you'll be prompted to create one.");
	if (gotoscout) {
		window.location = scouturl;
		return false;
	}
}

</script>
<script src="http://cdn.gigya.com/js/socialize.js?apiKey=3_BLRB_2LlQJZDUW1wb9_ZOps-sOnnzA_e6xxNSwJBBGoB-SavmPAKHkaVVZPE5Kx8"></script>
<script>
    $(document).ready(function() {
        var ua = new gigya.socialize.UserAction();
        var params = {
            containerID: 'share-buttons',
            layout: 'horizontal',
            shareButtons: [
                {
                    provider: 'facebook',
                },
                {
                    provider: 'googleplus'
                },
                {
                    provider: 'twitter',
                    related: 'sunfoundation',
                    via: 'sunfoundation'
                },
                {
                    provider: 'email'
                }
            ],
            userAction: ua
        };
        gigya.socialize.showShareBarUI(params);
    });
</script>

{% endblock %}
	